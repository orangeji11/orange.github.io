# 替换步骤
## 命名空间替换
1. 执行python脚本下载所有代码。
```python
import os,re,sys

from sys import argv
type = argv[1]

work_dir = "/root/uccps-scode/"+content
list = []
with open("gerrit-repo-"+content, 'r') as f:
    for line in f:
        repo = line.strip("\n")
        if repo in list:
            print(repo)
        else :
            list.append(repo)
        if not os.path.exists(repo):
            os.chdir(work_dir)
            os.system("git clone \"ssh://ut002948@10.30.38.104:29418/%s\" && scp -p -P 29418 ut002948@10.30.38.104:hooks/commit-msg \"%s/.git/hooks/\""%(repo,repo))
            os.chdir(repo)
            os.system("git checkout v1.2-ns")
            os.chdir(work_dir)
print(list)
```
2. 通过oc get ns获取带有openshift的命名空间名称，在代码中统一替换。
3. 修改changelog并进行一次commit。
```shell
sed -i '/"changelog":/a\\t{\n\t    "date": "2023-2-16",\n\t    "version": "1.2.1-rc9-5",\n\t    "author": "jizongyao",\n\t    "changes": "change the namespace name"\n\t},' utccp-changelog.json
```
4. 重新编译all。

### 注意：  
1. 需要更新bindata的项目去对应目录下执行  ./hack/update-generated-bindata.sh 脚本  
   + utccp-image-cluster-ingress-operator
   + utccp-image-cluster-dns-operator


### 问题：
1. 用修改过命名空间的utccp-installer创建集群，无法通过uswift用户连接到bootstrap节点。已解决：容器镜像代码未更新，使用rpm包修改安装。
2. 安装后boostrap提示命名空间uccps-config、uccps-machine-config-operator、uccps-machine-api、uccps-config-managed未找到。已解决：release镜像修改yaml格式错误导致创建失败。